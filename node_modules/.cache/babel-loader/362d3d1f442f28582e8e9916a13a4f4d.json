{"ast":null,"code":"import _slicedToArray from\"/home/jobilite/Desktop/hostel_client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useMutation,useQuery}from\"@apollo/react-hooks\";import{DELETE_STUDENT_MUTATION,FETCH_STUDENTS_QUERY,FETCH_STUDENT_QUERY}from\"../Query/graphql\";import Button from'@material-ui/core/Button';import{useConfirm}from'material-ui-confirm';import DeleteForeverIcon from\"@material-ui/icons/DeleteForever\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function DeleteButton(_ref){var postId=_ref.postId,callBack=_ref.callBack;var confirm=useConfirm();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),student=_useState2[0],setStudent=_useState2[1];var _useQuery=useQuery(FETCH_STUDENT_QUERY,{variables:{postId:postId}}),data=_useQuery.data;useEffect(function(){if(data){setStudent(data.getStudent);}},[data]);var _useMutation=useMutation(DELETE_STUDENT_MUTATION,{update:function update(proxy){//TODO: remove post from cache\n// const data = proxy.readQuery({\n//   query: FETCH_STUDENTS_QUERY\n// })\n// data.getStudents = data.getStudents.filter(p => p.id !== postId)\n// proxy.writeQuery({\n//   query: FETCH_STUDENTS_QUERY,\n//   data\n// })\nif(callBack){callBack();}},variables:{postId:postId}}),_useMutation2=_slicedToArray(_useMutation,1),deleteStudent=_useMutation2[0];var onDelete=function onDelete(){confirm({description:\"Did You Want To Delete  \".concat(student.childname,\" Permanently\")}).then(function(){return deleteStudent();}).catch(function(){return console.log(\"Deletion cancelled.\");});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Button,{onClick:onDelete,children:/*#__PURE__*/_jsx(DeleteForeverIcon,{})})});}export default DeleteButton;","map":{"version":3,"sources":["/home/jobilite/Desktop/hostel_client/src/components/DeleteButton.js"],"names":["React","useState","useEffect","useMutation","useQuery","DELETE_STUDENT_MUTATION","FETCH_STUDENTS_QUERY","FETCH_STUDENT_QUERY","Button","useConfirm","DeleteForeverIcon","DeleteButton","postId","callBack","confirm","student","setStudent","variables","data","getStudent","update","proxy","deleteStudent","onDelete","description","childname","then","catch","console","log"],"mappings":"2JAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,WAAT,CAAsBC,QAAtB,KAAsC,qBAAtC,CACA,OAASC,uBAAT,CAAkCC,oBAAlC,CAAwDC,mBAAxD,KAAmF,kBAAnF,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,OAASC,UAAT,KAA2B,qBAA3B,CACA,MAAOC,CAAAA,iBAAP,KAA8B,kCAA9B,C,gGAIA,QAASC,CAAAA,YAAT,MAA2C,IAAnBC,CAAAA,MAAmB,MAAnBA,MAAmB,CAAXC,QAAW,MAAXA,QAAW,CACzC,GAAMC,CAAAA,OAAO,CAAGL,UAAU,EAA1B,CAEA,cAA6BR,QAAQ,CAAC,EAAD,CAArC,wCAAOc,OAAP,eAAgBC,UAAhB,eAGA,cAAkBZ,QAAQ,CAACG,mBAAD,CAAsB,CAC9CU,SAAS,CAAE,CACTL,MAAM,CAANA,MADS,CADmC,CAAtB,CAA1B,CAAQM,IAAR,WAAQA,IAAR,CAMAhB,SAAS,CAAC,UAAM,CACd,GAAGgB,IAAH,CAAQ,CACNF,UAAU,CAACE,IAAI,CAACC,UAAN,CAAV,CACD,CACF,CAJQ,CAIN,CAACD,IAAD,CAJM,CAAT,CAQA,iBAAwBf,WAAW,CAACE,uBAAD,CAA0B,CAC3De,MAD2D,iBACpDC,KADoD,CAC7C,CACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACC,GAAGR,QAAH,CAAa,CAAEA,QAAQ,GAAI,CAC7B,CAZwD,CAa3DI,SAAS,CAAE,CACTL,MAAM,CAANA,MADS,CAbgD,CAA1B,CAAnC,8CAAOU,aAAP,kBAkBD,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CAEtBT,OAAO,CAAC,CAAEU,WAAW,mCAA6BT,OAAO,CAACU,SAArC,gBAAb,CAAD,CAAP,CACKC,IADL,CACU,iBAAOJ,CAAAA,aAAa,EAApB,EADV,EAEKK,KAFL,CAEW,iBAAOC,CAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ,CAAP,EAFX,EAGC,CALF,CAaC,mBACE,sCACE,KAAC,MAAD,EAAQ,OAAO,CAAEN,QAAjB,uBAEE,KAAC,iBAAD,IAFF,EADF,EADF,CASD,CAID,cAAeZ,CAAAA,YAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\nimport { DELETE_STUDENT_MUTATION, FETCH_STUDENTS_QUERY, FETCH_STUDENT_QUERY } from \"../Query/graphql\";\nimport Button from '@material-ui/core/Button';\nimport { useConfirm } from 'material-ui-confirm';\nimport DeleteForeverIcon from \"@material-ui/icons/DeleteForever\";\n\n\n\nfunction DeleteButton({ postId, callBack}) {\n  const confirm = useConfirm();\n\n  const [student, setStudent]= useState('')\n\n\n  const { data  } = useQuery(FETCH_STUDENT_QUERY, {\n    variables: {\n      postId\n    }\n  })\n\n  useEffect(() => {\n    if(data){\n      setStudent(data.getStudent)\n    }\n  }, [data])\n\n  \n\n  const [deleteStudent] = useMutation(DELETE_STUDENT_MUTATION, {\n    update(proxy) {\n        //TODO: remove post from cache\n        // const data = proxy.readQuery({\n        //   query: FETCH_STUDENTS_QUERY\n        // })\n        // data.getStudents = data.getStudents.filter(p => p.id !== postId)\n        // proxy.writeQuery({\n        //   query: FETCH_STUDENTS_QUERY,\n        //   data\n        // })\n         if(callBack) { callBack();}\n      },\n    variables: {\n      postId,\n    },\n  });\n\n const onDelete = () => {\n\n  confirm({ description: `Did You Want To Delete  ${student.childname} Permanently`  })\n      .then(() =>  deleteStudent() )\n      .catch(() =>  console.log(\"Deletion cancelled.\") );\n  };\n\n \n   \n\n    \n\n\n  return (\n    <>\n      <Button onClick={onDelete}\n      >\n        <DeleteForeverIcon />\n      </Button>\n    \n    </>\n  );\n}\n\n\n\nexport default DeleteButton;"]},"metadata":{},"sourceType":"module"}